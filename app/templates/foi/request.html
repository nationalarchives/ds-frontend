{% extends "base.html" %}

{%- from 'components/sidebar/macro.html' import tnaSidebar -%}
{%- from 'macros/back_to_top.html' import back_to_top -%}
{%- from 'macros/global_alert_banners.html' import global_alert_banners -%}
{%- from 'macros/meta.html' import meta -%}
{%- from 'macros/wagtail_streamfield.html' import wagtail_streamfield -%}

{%- set themeAccent = 'black' if page_data.mourning_notice else (themeAccent or 'blue') -%}
{%- set pageTitle = page_data.short_title or page_data.title -%}
{%- set breadcrumbsStyle = 'accent-light' -%}

{% block head %}
{{ super() }}
{{- meta(page_data) }}
    <link rel="canonical" href="{{ page_data.meta.url }}">
{% endblock head %}

{% block content %}
{%- if page_data.global_alert or page_data.mourning_notice %}
<div class="tna-background-accent-light">
  {{ global_alert_banners(page_data.global_alert, page_data.mourning_notice, None, 's') }}
</div>
{%- endif %}
<div class="tna-section tna-!--padding-top-m tna-background-accent-light">
  <div class="tna-container">
    <div class="tna-column tna-column--width-2-3 tna-column--width-5-6-medium tna-column--full-small tna-column--full-tiny">
      <hgroup class="tna-hgroup-xl">
        <p class="tna-hgroup__supertitle">{{ page_data.type_label }}</p>
        <h1 class="tna-hgroup__title">{{ page_data.title }}</h1>
      </hgroup>
      <dl class="tna-dl tna-dl--plain tna-dl--stacked tna-!--margin-top-m">
        <dt>Freedom of information request reference</dt>
        <dd>{{ page_data.reference }}</dd>
        <dt>Publication date</dt>
        <dd>{{ page_data.date | pretty_date }}</dd>
      </dl>
    </div>
  </div>
</div>
<div class="tna-section tna-!--no-padding-top">
  <div class="tna-container">
    <div class="tna-column tna-column--width-1-4 tna-column--margin-right-1-12 tna-column--width-1-3-medium tna-column--no-margin-right-medium tna-column--full-small tna-column--no-margin-right-small tna-column--full-tiny tna-column--no-margin-right-tiny tna-!--padding-top-m">
      {% set items = [
        {
          'text': 'Request',
          'href': '#request'
        },
        {
          'text': 'Outcome',
          'href': '#outcome'
        },
        {
          'text': 'Response',
          'href': '#response'
        }
      ] %}
      {%- if page_data.annexe %}
        {% set items = items + [{
          'text': 'Annexe',
          'href': '#annexe'
        }] %}
      {%- endif %}
      {{ tnaSidebar({
        'title': 'On this page',
        'headingLevel': 2,
        'items': items,
        'type': 'sections',
        'sticky': True,
        'classes': 'tna-!--padding-top-s',
        'attributes': {
          'id': 'page-sidebar'
        }
      }) }}
    </div>
    <div id="page-body" class="tna-column tna-column--width-2-3 tna-column--full-small tna-column--full-tiny tna-!--padding-top-m">
      <h2 class="tna-heading-l tna-!--padding-top-s" id="request">Request</h2>
      {{ wagtail_streamfield(page_data.request, 3) }}
      <h2 class="tna-heading-l" id="outcome">Outcome</h2>
      <p>{{ page_data.outcome_description }}.</p>
      <h2 class="tna-heading-l" id="response">Response</h2>
      {{ wagtail_streamfield(page_data.response, 3) }}
      {%- if page_data.annexe %}
      <h2 class="tna-heading-l" id="annexe">Annexe</h2>
      {{ wagtail_streamfield(page_data.annexe, 3) }}
      {%- endif %}
    </div>
  </div>
</div>
  {{ back_to_top('l') }}
{% endblock content %}

{% block bodyEnd %}
{{ super() }}
    <script src="{{ url_for('static', filename='sidebar.min.js', v=app_config.BUILD_VERSION) }}" defer></script>
{% endblock bodyEnd %}
